!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.tina={})}(this,function(t){"use strict";function n(t){var n=t.TargetClass,e=t.getSourceInstance;return t.properties.forEach(function(t){Object.defineProperty(n.prototype,t,{set:function(n){e(this)[t]=n},get:function(){var n=e(this),r=n[t];return"function"==typeof r?r.bind(n):r}})}),n}function e(){this.setData(),this.$log("Initial Mixin","Ready")}function r(){this.$log=this.constructor.log.bind(this.constructor),this.$log("Log Mixin","Ready")}function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},e={};for(var r in t)e[r]=n(t[r],r,t);return e}function i(t){var n={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(e){e in t&&(n[e]=t[e])}),n}function a(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter(function(t){return-1===n.indexOf(t)})}function u(t){return Object.keys(t).map(function(n){return t[n]})}function c(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(n){var e=m(n,2),r=e[0],o=e[1];return t[r]=o}),t}function s(t){return o(t||{},function(t,n){return function(){for(var t=this.__tina_instance__,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return t[n].apply(t,r)}})}function f(t,n){return c(t.map(function(t){var e=n(t);return[t,function(){var n=this.__tina_instance__;if(e&&n[e]&&n[e].apply(n,arguments),n[t])return n[t].apply(n,arguments)}]}))}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},h=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),d=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},y=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},v=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n},m=function(){return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)},b=function(t,n){return function(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={},o=function(o){r[o]=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];e&&n[o].apply(this,i),"function"==typeof t[o]&&t[o].apply(this,i),e||n[o].apply(this,i)}};for(var i in n)o(i);return d({},t,r)}(t,n,!0)},_={attached:e,onLoad:e},w={created:r,beforeLoad:r},x={App:App,Page:Page,Component:Component,wx:wx},A=function(t,n){return Array.isArray(t)?t.concat(n):"object"===(void 0===t?"undefined":l(t))?d({},t,n):n},O=function(){function t(){p(this,t)}return h(t,[{key:"setData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},e=d({},this.data,t);if("function"==typeof this.compute&&(e=d({},e,this.compute(e))),e=function(t,n){var e={};for(var r in t)t[r]!==n[r]&&(e[r]=t[r]);return e}(e,this.data),this.constructor.log("setData",e),function(t){if(null==t)return!0;if(t.length>0)return!1;if(0===t.length)return!0;for(var n in t)if(hasOwnProperty.call(t,n))return!1;return!0}(e))return n();this.$source.setData(e,n)}},{key:"data",set:function(t){throw new Error("Not allowed to set ``data``, use ``setData(data, [callback])`` instead.")},get:function(){throw new Error("class Basic doesnot have a ``data`` atttribute, please implement the ``data`` getter in the child-class.")}}],[{key:"mixin",value:function(t){this.mixins.push(t)}},{key:"mix",value:function(t,n){var e=this;if(Array.isArray(n))return n.reduce(function(t,n){return e.mix(t,n)},t);if("function"==typeof n)return this.mix(t,n(t,this));return d({},t,o(n,function(n,e){return A(t[e],n)}))}},{key:"log",value:function(t,n){this.debug&&console.log("[Tina."+this.name+"] - "+t+(n?": ":""),n)}}]),t}();O.debug=!1,O.mixins=[];var S=["data","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],P=["onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],j={onLoad:"beforeLoad"},$=[].concat(P,g(u(j))),k=d({mixins:[],data:{},compute:function(){}},c($.map(function(t){return[t,[]]})),{methods:{}}),D=[w,_],C=function(t){function n(t){var e,r=t.options,a=void 0===r?{}:r;t.$source;p(this,n);var u=v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),c=d({compute:a.compute||function(){return{}}},a.methods,o(i(a,$),function(t,n){return function(){for(var n=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.reduce(function(t,e){return e.apply(n,r.concat(t))},void 0)}}));for(var s in c)u[s]=c[s];return e=u,v(u,e)}return y(n,O),h(n,null,[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=this.mix(k,[].concat(D,g(this.mixins),g(t.mixins||[]),[t]));var e=d({},s(t.methods),f(P,function(t){return j[t]}));e=b(e,{onLoad:function(){var e=new n({options:t,$source:this});this.__tina_instance__=e,e.$source=this}}),new x.Page(d({},i(t,a(S,P)),e))}}]),h(n,[{key:"data",get:function(){return this.$source.data}}]),n}();C.mixins=[],n({TargetClass:C,getSourceInstance:function(t){return t.$source},properties:[].concat(g(a(["data","route"],["data"])),g(a(["setData"],["setData"])))});var E=["properties","data","methods","behaviors","created","attached","ready","moved","detached","relations","options"],R=["created","attached","ready","moved","detached"],L={},T=[].concat(R,g(u(L))),I=d({mixins:[],behaviors:[],properties:{},data:{},compute:function(){}},c(T.map(function(t){return[t,[]]})),{methods:{},relations:{},options:{}}),M=[w,_],B=function(t){function n(t){var e,r=t.options,a=void 0===r?{}:r;t.$source;p(this,n);var u=v(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),c=d({compute:a.compute||function(){return{}}},a.methods,o(i(a,T),function(t,n){return function(){for(var n=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.reduce(function(t,e){return e.apply(n,r.concat(t))},void 0)}}));for(var s in c)u[s]=c[s];return e=u,v(u,e)}return y(n,O),h(n,null,[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=this.mix(I,[].concat(M,g(this.mixins),g(t.mixins||[]),[t]));var e=d({properties:function(t){function n(t){return function(){var n=this.__tina_instance__;n.setData();for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return"string"==typeof t?n[t].apply(n,r):"function"==typeof t?t.apply(n,r):void 0}}return o(t||{},function(t){return"function"==typeof t||null===t?{type:t,observer:n()}:"object"===(void 0===t?"undefined":l(t))?d({},t,{observer:n(t.observer)}):void 0})}(t.properties),methods:s(t.methods)},f(R,function(t){return L[t]}));e=b(e,{created:function(){var e=new n({options:t,$source:this});this.__tina_instance__=e,e.$source=this}}),new x.Component(d({},i(t,a(E,R)),e))}}]),h(n,[{key:"data",get:function(){return this.$source.data}}]),n}();B.mixins=[],n({TargetClass:B,getSourceInstance:function(t){return t.$source},properties:[].concat(g(a(["is","id","dataset","data"],["data"])),g(a(["setData","hasBehavior","triggerEvent","createSelectorQuery","selectComponent","selectAllComponents","getRelationNodes"],["setData"])))}),t.Page=C,t.Component=B,Object.defineProperty(t,"__esModule",{value:!0})});